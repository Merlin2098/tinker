# agent_framework_config.yaml

deployment:
  framework_footprint:
    - agents/logic/
    - agents/tools/
    - .clinerules
    - agent_framework_config.yaml
    - agents/instructions/claude/
    - agents/instructions/chat/
    - agents/instructions/model_agnostic/

  host_gitignore_entries:
    - "# Tinker agent framework (portable - not part of host project)"
    - "agents/logic/"
    - "agents/tools/"
    - ".clinerules"
    - "agent_framework_config.yaml"
    - "agents/instructions/claude/"
    - "agents/instructions/chat/"
    - "agents/instructions/model_agnostic/"

  project_root_strategy: parent_of_agent_tools

active_profile: null

profile_detection:
  enabled: true
  fallback_profile: default
  rules:
    - profile: interactive_terminal
      match: any
      env_exists:
        - TERM_PROGRAM
        - SSH_TTY
    - profile: constrained_terminal
      match: any
      env_exists:
        - CI
        - GITHUB_ACTIONS

static_context:
  output_path: agents/logic/agent_outputs/context.json
  max_lines: 1000
  file_tree_max_depth: 2
  python_signatures_max_depth: 3

  truncation_policy:
    reducer_order:
      - trim_python_signatures
      - trim_file_tree
      - trim_schema_summaries
      - trim_agent_rules_sections
      - drop_python_signatures
      - drop_schema_summaries
      - drop_agent_rules_sections
      - drop_file_tree_to_minimum
    trim_fraction_percent: 10
    minimum_file_tree_entries: 0
    minimum_agent_rules_sections: 0
    minimum_schema_top_level_keys: 3

  excluded_dirs_from_tree:
    - agents/logic/skills
    - agents/logic/agent_outputs
    - agents/logic/agent_logs

  excluded_from_signatures:
    - agents/logic/skills

  always_excluded_dirs:
    - .git
    - __pycache__
    - node_modules
    - .venv
    - venv

static_context_profiles:
  constrained_terminal:
    max_lines: 700
    file_tree_max_depth: 2
    python_signatures_max_depth: 2
    truncation_policy:
      trim_fraction_percent: 15

  interactive_terminal:
    max_lines: 1200
    file_tree_max_depth: 3
    python_signatures_max_depth: 4
    truncation_policy:
      trim_fraction_percent: 8

on_demand_files:
  treemap:
    path: agents/logic/analysis/treemap.md
    description: >
      Full recursive file tree of the host project.
    format: markdown
    generated_by: agents/tools/treemap.py

  dependencies_report:
    path: agents/logic/analysis/dependencies_report.md
    description: >
      Python module dependency graph of the host project.
    format: markdown
    generated_by: agents/tools/analyze_dependencies.py

gitignore:
  respect_gitignore: true
  fallback_warning: >
    pathspec library not found. Only hard-coded exclusions will be applied.
    Run: pip install pathspec

data_governance:
  enabled: true

  environments:
    dev:
      allow_project_local_data_root: true
      debug_data_allowed: true
    test:
      allow_project_local_data_root: true
      debug_data_allowed: true
    prod:
      allow_project_local_data_root: false
      debug_data_allowed: false
      require_external_data_root: true

  default_data_root: data
  default_source_subdir: source
  default_output_subdir: output
  require_source_output_separation: true
  require_final_layer_from_materialized_inputs: true
  required_output_format_policy: per_use_case_declared

